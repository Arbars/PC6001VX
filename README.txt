PC6001VX マニュアル
by eighttails
http://eighttails.seesaa.net

【 概要 】
本プログラムは、ゆみたろ様(http://papicom.net)作のPC-6001エミュレータ
PC6001VをLinux等で動作するよう改変したものです。
PC6001VXの末尾のXはクロスプラットフォームのXです。(^^;
ターゲットはLinuxなどのUNIXライクOSを想定していますが、移植性の検証として
Windows用バイナリもリリースしています。が、こちらはほとんどおまけです。

【使い方】
オリジナルのPC6001Vからの機能の追加、削減は基本的になく、
GUIに関してもオリジナルを極力忠実に再現しましたので、
ゆみたろ様のオリジナルのマニュアルを参照してください。
ごめんなさいごめんなさい。
2.0の正式版までには、ちゃんとしたドキュメントを書きます。

初期設定では、ROMファイルの配置場所は
・Windowsの場合、EXEと同じ階層のromフォルダ(一度起動すると生成されます)
・Linuxの場合、~/.pc6001vx/romフォルダ(一度起動すると生成されます)
となります。
初回起動時に生成されるこのフォルダにROMファイルをコピーするか、
既存のROMフォルダが別にある場合は、そちらを選択することもできます。

【既知の不具合、制約事項】
・起動するたびにシステムの音量を変えてしまうことがあります。
　Qt5の音量制御周りはまだあまり枯れていないようです。
・X11では、なぜかかなキー(PAUSE)の利きが悪いです。


(バージョン1.0系列の不具合)
・Qt+SDLの組み合わせの制約上？フルスクリーン状態でメニューを出すことができません。
　フルスクリーンでマウス右クリックした場合、一旦ウィンドウモードに遷移します。
・Linux版では、メニュー外をクリックしてもメニューが閉じられないケースが発生します。
　この場合、メニューの上でマウスをしばらく動かしていると閉じられるようになります。
・リセット時にプチフリっぽい動きになることがあります。
・サウンドが突然止まることがあります。

【起動しない時は】
・まずは以下のページからDirectXのランタイムをインストールしてください。
　http://www.microsoft.com/ja-jp/download/details.aspx?id=35
・それでも起動しない時は、iniファイルを削除してください。
　Windows用にはsafemode.batを提供しています。
　safemode.batでは設定ファイルを削除し、セーフモード
　(表示のハードウェアアクセラレーションを一時的にオフ)で起動します。
　グラフィックボードが古くて画面が表示できない環境の人は、セーフモードで立ち上げて、
　設定画面からハードウェアアクセラレーションをオフに設定してください。

【ライセンス、免責事項】
ライセンスはオリジナルのPC6001Vのライセンスに従い、LGPLとします。
このプログラムを使用したことによるいかなる損害も作者のeighttailsは責任を持ちません。


【開発者情報】
　ビルドにはQt5(執筆時点の最新は5.3)が必要です。
　Qt5はまだ品質的に成熟しておらず、諸々の不具合を抱えていると心得ましょう。
・Windows
　MSYS2環境上でビルドします。
　1.こちら(http://sourceforge.net/projects/msys2/)から
　　MSYS2をダウンロードしてインストールしてください。。
　　VC++はサポートしていません。
　2.MSYSをインストールしたフォルダのmsys2_shell.batを実行
　3.MSYS Shell上で"pacman -Sy && pacman -Su"を実行し、環境をアップグレード
　4.ダウンロードしたPC6001VXのソースをMSYS上のホームフォルダに解凍。
  5.ソースフォルダのwin32フォルダにカレントを移動
  6."bash ./toochain.sh"を実行。ツールチェインをインストール
  7."bash ./buildenv.sh"を実行。QtのライブラリとQtCreatorをビルド
  　QtCreatorが/usr/local/bin/qtcreator.exe,Qtスタティック版が/usr/local/qt5-staticに
  　インストールされます。
　8.PC6001VX.proをQtCreatorで開いて、スタティック版Qtを指定してビルドしてください。

・Linux（Debian Sidの例　Ubuntuでもほぼ同様でしょう。）
　1."apt-get install build-essential mesa-common-dev libsdl2-dev qt5-sdk qtcreator libqt5multimedia5-plugins" を実行。
　2.ダウンロードしたPC6001VXのソースを解凍してください。
　3.PC6001VX.proをQtCreatorで開いてビルドしてください。
　　IDEが嫌な人はQtCreatorの代わりにqmakeとqtライブラリを揃えればビルドできるでしょう。

【謝辞】
オリジナルのPC6001Vを製作され、移植を快諾してくださったゆみたろ様、
Mac版を通じ、移植の障害を取り除いてくれていたであろうWindy様、
Qtについて勉強する機会を提供してくださった関東Qt勉強会および元NOKIAのエンジニアの皆様、
そしてP6の世界にいざなってくれた変態^H^H紳士達の皆様に厚く感謝申し上げます。

【更新履歴】
2.0Beta4 2014/08/15
・P6V1.22開発版ベースに更新
　FM音源対応(暫定版)
　未実装機能などの制約事項は本家に準じます。
・Androidの対応開始
　・対応OSはAndroid4.0以上、現時点でハードウェアキーボード必須です。
　・初回起動時はMinistroが立ち上がるのでそこからQtをダウンロードしてください。
　・エミュレーションメイン画面をタップで長押しするとメニューが出ます。
　・現時点では取り扱い注意の人柱版です。以下のような制約があります。
　【制約事項】
　・キーボードによっては入力できないキーがあります。
　　例えばASUSのTransformerシリーズのドックキーボードではファンクションキーがなく入力できません。
　・アプリがバックグラウンドに回った際、OSに勝手に終了させられることがあります。
　　終了時に自動的にどこでもSAVEするように対応する予定ですが、まだ未実装です。
　・バックグラウンドに回った場合、エミュレーションは一時停止しますが、
　　裏でCPUパワーとバッテリを消費してしまいます。
　　終了する際はメニューかタスクリストから終了してください。
　　PCでは発生しない現象なので調査が難航しています。
　・GUIが中華っぽいフォントで表示されてしまいます。
　・音が出たり出なかったりします。Androidのシステムサウンド設定をいじっていると
　　復活することがあるようです。

・iniファイルを2つに分けた
　・P6VX固有の機能追加に関する設定を扱いやすくするため、
　　本家P6Vと共通の設定はpc6001v.ini,P6VX固有の設定をpc6001vx.iniに分離しました。
　　エラーが出る場合、iniファイルを一度削除してください。

・ドットカクカク表示対応
　・一部の方から要望のあった、ドットのカクカク表示に対応しました。
　・以下の手順をで設定するとドットがカクカク表示になります。
　　・メニューの設定→4:3表示をオフ
　　・メニューの設定→フィルタリングをオフ
　　・メニューの設定→表示サイズから整数倍の倍率を指定
　　・メニューの設定→表示サイズ→倍率を固定をオン

・ウィンドウサイズ、表示サイズを設定ファイルに記憶するようにした。
・TALK文の固定語再生を実装(今まで未実装でしたすみません)
　・waveフォルダにf41.wav~f44.wavを配置してください。
　・作者は44kHzモノラルのWAVで動作確認しています。
・リプレイ関係のバグをいくつか修正
・CRC違いのROMで起動しようとした際にクラッシュすることがあるのを修正

2.0Beta3 2014/04/10
・(Windows)グラフィクスタックにANGLE経由のDirectXを使うようにした。
　IntelGPUでもハードウェアアクセラレーションが有効になり、軽くなる効果が期待できます。
　XPでは正常に動作しない可能性があり、勝手ながら本バージョンからXPは非サポートとします。
 起動しない場合は、以下のページからDirectXのランタイムをインストールしてください。
 http://www.microsoft.com/ja-jp/download/details.aspx?id=35

・Merged English translation.(Thanks Anna Wu!)
　When display language of OS is not Japanese, GUI of PC6001VX is displayed in English.
・リプレイ関連機能強化
　・リプレイ記録中に途中保存することができるようになった。
　　リプレイメニューから「途中保存」「途中保存から再開」を選択することでリプレイを
　　記録しながらプレイのやり直しができます。
　　途中保存ファイルはリプレイファイルと同一フォルダにresume.ddsというファイル名で保存されます。
　　複数リプレイファイルを同一フォルダに置く場合は注意が必要です。
　　また、途中保存ファイルは記録停止時にも保存されます。
　　リプレイ記録開始時に「記録再開...」を選んで既存のリプレイファイルを選択すると記録停止した時点から
　　リプレイを追記することができます。
　　リプレイファイルが完成したらresume.ddsファイルは不要ですので削除して結構です。
・リプレイに関する既知の問題、制約事項
　・オートスタートが設定されているテープイメージを使っていると途中保存が正しく行われません。
　・シフトキー、ALTキー(GRPH)の入力を伴うリプレイは正しく再生されないようです。
　　このへんは本家では修正済みのようなのでリリースされ次第マージします。
　・リプレイ記録中にマウスホイールで速度変更をすると再生が正しく行われません。
　・途中ディスク、テープに書き込むするリプレイはイメージを破損するおそれがあります。
・どこでもSAVE/LOADにショートカットキー割り当て
　無変換/変換キーでスロットの1番を使ってどこでもSAVE/LOADを行います。
　リプレイ記録中は途中保存/途中保存から再開になります。
・本家P6Vに実装済みだった、マウスホイールでスピード調整する機能を実装。
・リプレイ再生中にTILTの動きを再現するようになった。
・ウィンドウモードでもTILTするようになった。
　・ステータスバーを非表示にするとディスプレイ枠が表示されます。

2.0Beta2 2014/01/22
バグ修正
・どこでもLOAD時にクラッシュするのを修正
・サンプリングレートを22050Hzにしていると落ちるのを修正
・サウンドのマスターボリュームを変えてしまう問題は解消していませんが、
　とりあえず右クリックしただけで音量がデフォルトに戻ってしまうのを修正
・フルスクリーン時に表示される幅1ピクセルの謎の枠を表示されないようにした。
・起動時のウィンドウのサイズ計算をちょっと修正

2.0Beta1 2014/01/15
・P6V1.21開発版ベースに更新
　SR対応(暫定版)、PC-6001Aに対応
　SR対応の制約事項(FM音源に未対応など)は本家に準じます。
・TILTモードの改良
　初代機、6001A選択時はモニター枠としてPC-6042Kが表示されるようにした。
　キーボードでもTILTモードが使えるようにした。

2.0Alpha3 2013/08/18
・P6V1.19ベースに更新
・OpenGLの機能チェックを改善
　Windows上でのIntelGPUなど、QtでOpenGLを使うための機能要件を満たさない場合、
  自動的にソフトウェアレンダリングになります。
・設定ダイアログを、より小さな画面に収まるようにレイアウトを修正
・「=」が入力できないのを修正
・「カタカナ/ひらがな」キーをかなキーにマップした(X11でPAUSEが効きにくい対策)
・ウィンドウ最大化時にモニタモードやスキャンラインなど、
　ウィンドウサイズが変わる操作をした場合に表示倍率が維持されないのを修正。
・TILTモード中にモニタモードに入った場合ディスプレイ枠を消すようにした。
・再起動時にジョイスティックが使えなくなるのを修正
・(Windows)ビルドにQt5.1を使用

2.0Alpha2 2013/05/25(オフ会記念リリース)
・TILTモードにディスプレイの枠が表示されるようになった(フルスクリーン時のみ)
　Hashiさん、MORIANさん、THANKS!
他、主にバグ修正
・遅いマシンでフリーズすることがあるのを修正(スケジューラのウェイト計算ミス)
・設定画面でキーボード入力が効かないのを修正
・4:3表示の際、画面下にゴミが出ているのを修正
・メニュー表示中に右クリックすると二重にメニューが表示されてしまうのを修正
・スナップショット保存が動いていなかったのを修正
・(Windows)初回起動時のROMフォルダ選択ダイアログで「いいえ」を選択すると
　GUIが暴走するのを修正

2.0Alpha 2013/05/07
・SDLで行われていたグラフィック描画、イベント処理、キー入力、サウンド出力をQt5に移行。
　これにより、バージョン1.0系列の既知の不具合は解消。
　ただし新たな不具合も発生(汗
・グラフィックの描画にQtを使用
　QtとOpenGLを用いた無段階の拡大縮小が可能になっています。
　また、4:3表示もQt側で引き伸ばしを行うことで自然な表示になっています。
　また、環境設定の色数設定はなくなりました。
　内部処理は256色、描画はディスプレイの色深度で固定になります。
・ジョイスティック入力のみSDL2を使用。　
　proファイルにて、DEFINES+=NOJOYSTICKと指定すると、
　ジョイスティックサポートが外れる代わりに、Qt5のみで全てビルド可能。
・ZLib,libPNGが不要になった。
・TILTモードの追加
　3DS版のスペースハリアーに触発されて作ったジョーク機能です。
　ジョイスティックの左右に反応して、画面が傾きます。(笑
　キーリピートの関係でカーソルキーには対応できませんでした。すみません。
　一応スペハリを想定して作っていますが、オリオンでもなかなか良い感じに酔えます。
　その他、クエスト、バンダル、AX-9、アステロイドチューブ、プラズマラインなど、
　3D視点のゲームでお楽しみください。(ジョイスティックに対応してればの話ですが)
　Qtではグラフィックの拡大縮小回転が簡単に行えるので、そのデモンストレーションでもあります。
・フォントファイルはバイナリに埋め込んだリソースから直接読むようにした。
　fontフォルダを作らなくなった。
・従来M+Outlineから生成していたフォントファイルをM+Bitmapベースに切り替えた。
　だいぶ見やすくなったと思います。
・スケジューラーのウェイト計算方法を変えた。
　CPU使用率も下がって、サウンドのバッファアンダーフローによるプチノイズもだいぶ減ったと思います。


1.01　2013/01/02
・P6V1.17ベースに更新
　本家に取り込まれた色にじみコードを再取り込み。にじみSet1に対応。
・右クリックメニューに「終了」がなかったのを修正(汗

1.0　2012/11/30
・P6V1.16ベースに更新
・新色にじみ方式(通称J方式)のにじみカラー出力を実装
・初回起動時にROMフォルダを指定できるようにした。
・二重起動防止にQtSingleApplicationを使用。ロックファイルを作らなくなった。
・スレッド処理にTLS(スレッド局所記憶)を使わないようにした。
・ステータスバー、モニタモード用の半角英数フォントを手作業でちまちま修正した。
　多少見やすくなったと思います。
・(Windows)ライブラリを可能な限りスタティックリンクにした。
・(Windows)ゆみたろさんのパッチを当ててSDLをビルド。今までサボってましたすみません。
・(非Windows)TAPE,DISKなどのフォルダのデフォルト設定を空白にした。
　明示的に設定しない場合、ホームフォルダから探しにいきます。

1.0β2　2012/03/09
バグ修正
・CRCが合わないROMを使用している場合、警告を出した上でCRCチェックを無効にできるようにした。
・ボリュームの設定が全てマスターに反映されてしまうのを修正。
・スキャンライン輝度が常に1として保存されてしまうのを修正。

1.0β　2012/02/06
初リリース。　P6V1.13ベース
