#include "breakpoint.h"


#ifndef NOMONITOR	// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ //

////////////////////////////////////////////////////////////////
// コンストラクタ
////////////////////////////////////////////////////////////////
BPoint::BPoint( void )
{
	// ブレークポイント初期化
	for( int i=0; i<NR_BP; i++ ) BP[i].Type = BP_NONE;
	ReqBreak = FALSE;
	ReqBPNum = 0;
        BPNo = 0;
        BPData = 0;
        BPStr = NULL;
}


////////////////////////////////////////////////////////////////
// デストラクタ
////////////////////////////////////////////////////////////////
BPoint::~BPoint( void ){}


////////////////////////////////////////////////////////////////
// ブレークポイントの有無をチェック
////////////////////////////////////////////////////////////////
BOOL BPoint::ExistBreakPoint( void )
{
	for( int i=0; i<NR_BP; i++ )
		if( BP[i].Type != BP_NONE ) return TRUE;
	
	return FALSE;
}


////////////////////////////////////////////////////////////////
// ブレークポイントをチェック
////////////////////////////////////////////////////////////////
BOOL BPoint::CheckBreakPoint( BPtype type, WORD addr, BYTE data, char *str )
{
	for( int i=0; i<NR_BP; i++ ){
		if( BP[i].Type == type && BP[i].Addr == addr ){
			BPNo   = i+1;
			BPAddr = addr;
			BPData = data;
			BPStr  = str;
			
			ReqBreak = TRUE;
			ReqBPNum = i;
			
			return TRUE;
		}
	}
	return FALSE;
}


////////////////////////////////////////////////////////////////
// ブレークポイントの情報をクリア
////////////////////////////////////////////////////////////////
void BPoint::ClearStatus( void )
{
	BPNo   = BP_NONE;
	BPAddr = 0;
	BPData = 0;
	BPStr  = NULL;
}


////////////////////////////////////////////////////////////////
// ブレークポイントのタイプを取得
////////////////////////////////////////////////////////////////
BPoint::BPtype BPoint::GetType( int num )
{
	return BP[num].Type;
}


////////////////////////////////////////////////////////////////
// ブレークポイントのアドレスを取得
////////////////////////////////////////////////////////////////
WORD BPoint::GetAddr( int num )
{
	return BP[num].Addr;
}


////////////////////////////////////////////////////////////////
// ブレークポイントのタイプを設定
////////////////////////////////////////////////////////////////
void BPoint::SetType( int num, BPtype type )
{
	BP[num].Type = type;
}


////////////////////////////////////////////////////////////////
// ブレークポイントのアドレスを設定
////////////////////////////////////////////////////////////////
void BPoint::SetAddr( int num, WORD addr )
{
	BP[num].Addr = addr;
}


////////////////////////////////////////////////////////////////
// ブレーク要求あり?
////////////////////////////////////////////////////////////////
BOOL BPoint::IsReqBreak( void )
{
	return ReqBreak;
}


////////////////////////////////////////////////////////////////
// ブレーク要求のあったブレークポイントNo.を取得
////////////////////////////////////////////////////////////////
int BPoint::GetReqBPNum( void )
{
	return ReqBPNum;
}


////////////////////////////////////////////////////////////////
// ブレーク要求キャンセル
////////////////////////////////////////////////////////////////
void BPoint::ResetBreak( void )
{
	ReqBreak = FALSE;
	ReqBPNum = 0;
}


#endif				// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ //
